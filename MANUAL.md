# OneDrive運用ツール マニュアル

## 概要
OneDrive運用ツールは、OneDriveの使用状況確認や問題診断を行うためのツールセットです。このツールを使用することで、OneDriveの運用管理が容易になります。

## 前提条件
- Windows 10/11
- 管理者権限
- PowerShell 5.1以上
- インターネット接続（モジュールのインストール時）
- Microsoft Graph PowerShellモジュール（自動インストールされます）

## システム要件
- CPU: 1GHz以上
- メモリ: 2GB以上
- ディスク空き容量: 500MB以上
- ディスプレイ解像度: 1280x720以上推奨

## セットアップ方法
1. `setup.bat`を**管理者として実行**します
   - 右クリックから「管理者として実行」を選択してください
2. セットアップ中に以下の処理が行われます:
   - 必要なフォルダの作成（logs, 診断, 修正ツール）
   - PowerShell実行ポリシーの確認と設定
   - 必要なPowerShellモジュールのインストール（オプション）

## 起動方法
以下のいずれかの方法で起動できます：
1. `start.bat` ファイルをダブルクリック
2. `OneDriveReportShortcut.bat` を直接実行

## 主な機能

### 1. OneDriveステータスレポート
- **機能**: OneDriveの使用状況を確認します
- **詳細**: ユーザーごとのOneDrive使用容量、共有状況などを確認できます
- **使用方法**: メインメニューから「1. OneDriveステータスレポート作成」を選択

### 2. OneDrive接続診断
- **機能**: OneDriveの接続問題を診断します
- **詳細**: ネットワーク接続、権限設定、同期状態などを確認し、問題がある場合は解決策を提示します
- **使用方法**: メインメニューから「2. OneDrive接続診断ツール実行」を選択

### 3. 文字化け修正
- **機能**: スクリプトや設定ファイルの文字化けを修正します
- **詳細**: 文字コードの問題を検出し、適切な文字コードに変換します
- **使用方法**: メインメニューから「3. 文字化け修正ツール起動」を選択

## フォルダ構成
- `logs/`: ログファイルの保存先
- `診断/`: 診断ツール関連ファイル
- `修正ツール/`: 文字化け修正などの修復ツール

## トラブルシューティング

### セットアップ時の問題

#### 文字化けが発生する場合
文字化けが発生する場合は、以下の対応を試してください:
- コントロールパネル > 地域と言語 > 管理タブ > 言語を追加の設定で「Unicode UTF-8を使用」にチェックを入れる
- 再起動後に再試行
- または、`fix_folders.bat` を実行して文字化けしたフォルダを修復

#### PowerShellモジュールのインストールエラー
モジュールのインストールに失敗した場合:
1. PowerShellを管理者として実行
2. 以下のコマンドを実行:
```powershell
Install-Module Microsoft.Graph.Authentication -Scope CurrentUser -Force
Install-Module Microsoft.Graph.Users -Scope CurrentUser -Force
Install-Module Microsoft.Graph.Files -Scope CurrentUser -Force
```

#### PowerShell実行ポリシーのエラー
実行ポリシーが制限されている場合:
1. PowerShellを管理者として実行
2. 以下のコマンドを実行:
```powershell
Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy RemoteSigned -Force
```

### 実行時の問題

#### ツールが起動しない場合
- セットアップが正常に完了しているか確認
- `debug.bat` を実行して、診断情報を確認
- すべてのファイルが正しい場所に存在するか確認

#### エラーメッセージが表示される場合
- エラーメッセージを記録
- `logs` フォルダ内のログファイルを確認
- `debug.bat` を実行してシステム情報を収集

## 更新履歴
- 2023/11/01: 初版リリース
- 2023/11/15: 文字化け問題の修正
- 2023/12/01: 診断機能の強化

## サポート
問題が解決しない場合は、IT部門にお問い合わせください。
問題報告時には以下の情報をお知らせください：
- 発生している問題の詳細
- 実行したコマンドやクリックした項目
- 表示されたエラーメッセージの全文
- `debug.bat` の実行結果