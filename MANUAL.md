# OneDrive運用ツール マニュアル

## 概要
OneDrive運用ツールは、OneDriveのステータス確認や問題診断、ファイル管理を支援するツールセットです。

## 目次
1. [システム要件](#システム要件)
2. [初回セットアップ](#初回セットアップ)
3. [基本機能](#基本機能)
4. [トラブルシューティング](#トラブルシューティング)
5. [よくある質問](#よくある質問)

## システム要件
- Windows 10以上
- PowerShell 5.1以上
- .NET Framework 4.7.2以上
- Microsoft Graph PowerShellモジュール
- 管理者権限（一部機能）

## 初回セットアップ
1. `setup.bat`を管理者権限で実行
2. 必要なPowerShellモジュールのインストールを許可
3. 画面の指示に従い、必要な権限を付与

## 基本機能

### 1. OneDriveステータスレポート
OneDriveの使用状況、問題ファイル、同期状態などを確認できます。

#### 使用方法
1. メインメニューから「OneDriveステータスレポート作成」を選択
2. 管理者資格情報を入力（必要な場合）
3. レポートの出力先を確認
4. レポート内容を確認

### 2. OneDrive接続診断ツール
OneDrive接続に関する問題を診断します。

#### 使用方法
1. メインメニューから「OneDrive接続診断ツール実行」を選択
2. 診断プロセスが完了するまで待機
3. 診断結果と推奨される対応を確認

### 3. 文字化け修正ツール
スクリプトや設定ファイルの文字化けを修正します。

#### 使用方法
1. メインメニューから「文字化け修正ツール起動」を選択
2. 修正したいファイルを選択
3. 「エンコーディング変換」をクリック

### 4. ファイル検索ツール
OneDrive内のファイルを検索します。

#### 使用方法
1. `OneDrive検索ツール.bat`を実行
2. 検索オプションを選択
   - ファイル名で検索
   - ファイル内容で検索
   - 最近変更されたファイルを表示
   - 大きいファイルを検索
3. 検索条件を入力
4. 結果を確認

### 5. 不要ファイル削除
一時ファイルや不要なファイルを整理します。

#### 使用方法
1. `不要ファイル削除.bat`を実行
2. 削除候補から削除したいファイルを選択
3. 確認後、削除を実行

### 6. フォルダ整理
フォルダ構造を整理し、不要なファイルを削除します。

#### 使用方法
1. `ツール整理.bat`を実行
2. 処理の完了を待機

## トラブルシューティング

### 文字化けの問題
ファイルやコンソール出力に文字化けが発生した場合：
1. `PowerShellEncoding.bat`を実行して文字化けを修正
2. `修正ツール\EmergencyRepair.bat`で緊急修復を実行

### 権限の問題
権限関連のエラーが発生した場合：
1. コマンドプロンプトを管理者として実行
2. その後、目的のバッチファイルを実行

### モジュールのインストール失敗
PowerShellモジュールのインストールが失敗した場合：
```powershell
Install-Module Microsoft.Graph.Authentication -Scope CurrentUser -Force
Install-Module Microsoft.Graph.Users -Scope CurrentUser -Force
Install-Module Microsoft.Graph.Files -Scope CurrentUser -Force
```

### 実行ポリシーの問題
PowerShellスクリプト実行エラーが発生した場合：
```powershell
Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy RemoteSigned
```

## よくある質問

**Q: OneDriveステータスレポートはどのくらいの頻度で実行すべきですか？**  
A: 環境によって異なりますが、週1回程度の実行が推奨されます。問題が疑われる場合はより頻繁に実行してください。

**Q: スクリプトが文字化けするのはなぜですか？**  
A: 異なるエンコーディング（ShiftJISとUTF-8など）が混在していることが原因です。`PowerShellEncoding.bat`を実行して修正してください。

**Q: このツールは管理者権限が必要ですか？**  
A: 一部の機能（特にシステム診断や設定変更）には管理者権限が必要です。基本的な機能は通常権限でも動作します。

**Q: 古いレポートはどのように管理すればよいですか？**  
A: `ツール整理.bat`を実行すると、最新のレポート以外は自動的に削除されます。重要なレポートは別の場所に保存しておくことをお勧めします。

**Q: OneDrive検索ツールはクラウド上のファイルも検索できますか？**  
A: ローカルに同期されているファイルのみが検索対象です。オンデマンドファイルや未同期ファイルは検索できません。